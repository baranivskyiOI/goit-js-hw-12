{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import Axios from 'axios';\n\nconst axios = Axios.create({\n  baseURL: 'https://pixabay.com/api/',\n  params: {\n    key: '50386790-558288da927f62b3f4194a21d',\n  },\n});\n\nexport default async function getImagesByQuery(query, page, per_page = 15) {\n  const res = await axios.get('', {\n    params: {\n      q: query,\n      page: page,\n      per_page: per_page,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: true,\n    },\n  });\n  return {\n    hits: res.data.hits,\n    total: res.data.totalHits,\n  };\n}\n","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nlet lightbox;\n\nconst imagesList = document.querySelector('.gallery');\nconst loader = document.querySelector('.loader');\nconst loadMoreBtn = document.querySelector('.more-btn');\n\nfunction IMGelement(\n  comments,\n  likes,\n  views,\n  downloads,\n  largeImageURL,\n  webformatURL,\n  tags\n) {\n  return `\n        <li class=\"card\">\n          <div class=\"img-container\">\n            <a href=\"${largeImageURL}\">\n              <img class=\"card-image\" src=\"${webformatURL}\" alt=\"${tags}\" />\n            </a>\n          </div>\n          <ul class=\"card-stats\">\n            <li><b>Likes</b><span>${likes}</span></li>\n            <li><b>Views</b><span>${views}</span></li>\n            <li><b>Comments</b><span>${comments}</span></li>\n            <li><b>Downloads</b><span>${downloads}</span></li>\n          </ul>\n        </li> \n    `;\n}\n\nfunction IMGelements(imgs) {\n  return imgs\n    .map(elem => {\n      const {\n        comments,\n        likes,\n        views,\n        downloads,\n        largeImageURL,\n        webformatURL,\n        tags,\n      } = elem;\n      return IMGelement(\n        comments,\n        likes,\n        views,\n        downloads,\n        largeImageURL,\n        webformatURL,\n        tags\n      );\n    })\n    .join('');\n}\n\nfunction clearGallery() {\n  imagesList.innerHTML = '';\n}\n//!=============================================================\n\nexport function renderInitialGallery(imgArr) {\n  clearGallery();\n  imagesList.innerHTML = IMGelements(imgArr);\n  refreshLightbox();\n}\n//!=============================================================\nexport function appendToGallery(imgArr) {\n  imagesList.insertAdjacentHTML('beforeend', IMGelements(imgArr));\n  refreshLightbox();\n}\n//!=============================================================\n\nfunction refreshLightbox() {\n  if (!lightbox) {\n    lightbox = new SimpleLightbox('.card a', {\n      captionsData: 'alt',\n      captionDelay: 250,\n    });\n  } else {\n    lightbox.refresh();\n  }\n}\n\nexport function showLoadMoreButton() {\n  loadMoreBtn.classList.remove('is-hidden');\n}\nexport function hideLoadMoreButton() {\n  loadMoreBtn.classList.add('is-hidden');\n}\nexport function showLoader() {\n  loader.classList.add('is-visible');\n}\nexport function hideLoader() {\n  loader.classList.remove('is-visible');\n}\n","import getImagesByQuery from './js/pixabay-api';\nimport {\n  showLoader,\n  hideLoader,\n  showLoadMoreButton,\n  hideLoadMoreButton,\n  renderInitialGallery,\n  appendToGallery,\n} from './js/render-functions';\n\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nconst per_page = 15;\n\nlet page = 1;\nlet currentQuery = '';\nlet totalHits = 0;\n//!=============================================================\n\nconst form = document.querySelector('.form');\nconst loadMoreBtn = document.querySelector('.more-btn');\n\nform.addEventListener('submit', async e => {\n  e.preventDefault();\n\n  const formText = e.target.elements['search-text'].value.trim();\n\n  currentQuery = formText;\n  page = 1;\n\n  if (!formText) return;\n\n  showLoader();\n\n  try {\n    const { hits, total } = await getImagesByQuery(formText, page);\n\n    totalHits = total;\n\n    showLoadMoreButton();\n\n    renderInitialGallery(hits);\n\n    if (!hits.length) {\n      iziToast.error({\n        title: 'Error',\n        message: `Sorry, there are no images matching your search query. Please try again!`,\n      });\n      hideLoadMoreButton();\n      return;\n    }\n    updateBtnStatus();\n  } catch (error) {\n    iziToast.error({\n      title: 'Error',\n      message: `${error}`,\n    });\n  } finally {\n    hideLoader();\n  }\n\n  form.reset();\n});\n\n//!=============================================================\nfunction updateBtnStatus() {\n  if (page * per_page < totalHits) {\n    showLoadMoreButton();\n  } else {\n    iziToast.error({\n      title: 'Error',\n      message: `We're sorry, but you've reached the end of search results.`,\n    });\n    hideLoadMoreButton();\n  }\n}\n//!=============================================================\n\nloadMoreBtn.addEventListener('click', async () => {\n  page += 1;\n  showLoader();\n\n  try {\n    const { hits, total } = await getImagesByQuery(currentQuery, page);\n    totalHits = total;\n\n    appendToGallery(hits);\n    scrollPage();\n    updateBtnStatus();\n  } catch (error) {\n    iziToast.error({\n      title: 'Error',\n      message: `${error}`,\n    });\n  } finally {\n    hideLoader();\n  }\n});\n\n//!=============================================================\n\nfunction scrollPage() {\n  const firstCard = document.querySelector('.gallery .card');\n\n  if (!firstCard) return;\n\n  const cardHeight = firstCard.getBoundingClientRect().height;\n\n  window.scrollBy({\n    top: cardHeight * 2,\n    behavior: 'smooth',\n  });\n}\n"],"names":["axios","Axios","getImagesByQuery","query","page","per_page","res","lightbox","imagesList","loader","loadMoreBtn","IMGelement","comments","likes","views","downloads","largeImageURL","webformatURL","tags","IMGelements","imgs","elem","clearGallery","renderInitialGallery","imgArr","refreshLightbox","appendToGallery","SimpleLightbox","showLoadMoreButton","hideLoadMoreButton","showLoader","hideLoader","currentQuery","totalHits","form","formText","hits","total","iziToast","updateBtnStatus","error","scrollPage","firstCard","cardHeight"],"mappings":"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"}